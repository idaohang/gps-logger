<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>gLogger Mini: /home/martin/GitHub/gps-logger/src/modules/nofs.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">gLogger Mini
   &#160;<span id="projectnumber">1.6</span>
   </div>
   <div id="projectbrief">A simple and small GPS logging device</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('nofs_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">/home/martin/GitHub/gps-logger/src/modules/nofs.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Library for accessing a NoFS (NoFileSystem) on the memory card.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sdmmc_8h_source.html">modules/sdmmc.h</a>&quot;</code><br/>
</div>
<p><a href="nofs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a2ae5e08bf4c1814adbe87a04a24781db">NOFS_BUFFER_SIZE</a>&#160;&#160;&#160;<a class="el" href="sdmmc_8h.html#aa66a0ce0481ba54361206778601760bc">SDMMC_SECTOR_SIZE</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the NoFS-Buffer (equals the block size on a memory card)  <a href="#a2ae5e08bf4c1814adbe87a04a24781db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a648c616fd78dc59388a3cd5bd2a6f6ba">NOFS_HEADER</a>&#160;&#160;&#160;&quot;k621.de&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The header which identifies a valid NoFS memory card.  <a href="#a648c616fd78dc59388a3cd5bd2a6f6ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a709f2b77791c1cfdeb1bfbda6d0e37bc">NOFS_HEADER_LENGTH</a>&#160;&#160;&#160;7</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of NOFS_HEADER.  <a href="#a709f2b77791c1cfdeb1bfbda6d0e37bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a2f65ce5e939d901d2b0d4f1f37ac6e04">NOFS_TERMINAL</a>&#160;&#160;&#160;<a class="el" href="global_8h.html#af02558e983dd26832a852bf186ed6726">ETX</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The byte which is written to indicate the end of a NoFS partition.  <a href="#a2f65ce5e939d901d2b0d4f1f37ac6e04"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a050245f618719c9f18f003792d835ed7">nofs_init</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the NoFS. Locks the processor in case of error.  <a href="#a050245f618719c9f18f003792d835ed7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a2ccac30932e224986477db6ae166b688">nofs_writeString</a> (char *pString)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a character string to the present data.  <a href="#a2ccac30932e224986477db6ae166b688"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nofs_8h.html#a941047467006697122d156cfb29fb11b">nofs_flush</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the current data buffer onto the memory card.  <a href="#a941047467006697122d156cfb29fb11b"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Library for accessing a NoFS (NoFileSystem) on the memory card. </p>
<p>Some notes regarding the NoFS:</p>
<ul>
<li>The very first bytes of a device are always the same and equal to the NOFS_HEADER string (currently "k621.de"). This header is used to identify if a device contains a valid NoFS or not</li>
<li>Starting with firmware version 1.5, the NOFS_HEADER is followed by an uint32_t value (MSB first), containing the number of a sector which is definitely _before_ the NOFS_TERMINAL byte, but as close to it as possible. This enhances the inital scan to determine the writing position as the application can jump directly to the specified sector and begin the scanning from there on.</li>
<li>After this integer, the actual data starts. Basically the data bytes can contain every value except for NOFS_TERMINAL. Preferrably the data should contain only printable ASCII characters (including \r, \n &amp; \t), though.</li>
<li>The data must be terimanted with a NOFS_TERMINAL. This byte is placed always in the _first_ byte of the sector which follows the last sector with actual data as well directly after the last data byte. Example: if the data goes until sector #42, byte #234, the NOFS_TERMINAL has to be written to sector #42, byte #235 as well as sector #43, byte #0. The application should ensure that there is always at least one NOFS_TERMINAL present on the device (i.e. write the new NOFS_TERMINALs _before_ overwriting the old ones).</li>
</ul>
<dl class="author"><dt><b>Author:</b></dt><dd>Martin Matysiak </dd></dl>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a2ae5e08bf4c1814adbe87a04a24781db"></a><!-- doxytag: member="nofs.h::NOFS_BUFFER_SIZE" ref="a2ae5e08bf4c1814adbe87a04a24781db" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="nofs_8h.html#a2ae5e08bf4c1814adbe87a04a24781db">NOFS_BUFFER_SIZE</a>&#160;&#160;&#160;<a class="el" href="sdmmc_8h.html#aa66a0ce0481ba54361206778601760bc">SDMMC_SECTOR_SIZE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Size of the NoFS-Buffer (equals the block size on a memory card) </p>

</div>
</div>
<a class="anchor" id="a648c616fd78dc59388a3cd5bd2a6f6ba"></a><!-- doxytag: member="nofs.h::NOFS_HEADER" ref="a648c616fd78dc59388a3cd5bd2a6f6ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="nofs_8h.html#a648c616fd78dc59388a3cd5bd2a6f6ba">NOFS_HEADER</a>&#160;&#160;&#160;&quot;k621.de&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The header which identifies a valid NoFS memory card. </p>

</div>
</div>
<a class="anchor" id="a709f2b77791c1cfdeb1bfbda6d0e37bc"></a><!-- doxytag: member="nofs.h::NOFS_HEADER_LENGTH" ref="a709f2b77791c1cfdeb1bfbda6d0e37bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="nofs_8h.html#a709f2b77791c1cfdeb1bfbda6d0e37bc">NOFS_HEADER_LENGTH</a>&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The length of NOFS_HEADER. </p>

</div>
</div>
<a class="anchor" id="a2f65ce5e939d901d2b0d4f1f37ac6e04"></a><!-- doxytag: member="nofs.h::NOFS_TERMINAL" ref="a2f65ce5e939d901d2b0d4f1f37ac6e04" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="nofs_8h.html#a2f65ce5e939d901d2b0d4f1f37ac6e04">NOFS_TERMINAL</a>&#160;&#160;&#160;<a class="el" href="global_8h.html#af02558e983dd26832a852bf186ed6726">ETX</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The byte which is written to indicate the end of a NoFS partition. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a941047467006697122d156cfb29fb11b"></a><!-- doxytag: member="nofs.h::nofs_flush" ref="a941047467006697122d156cfb29fb11b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="nofs_8h.html#a941047467006697122d156cfb29fb11b">nofs_flush</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes the current data buffer onto the memory card. </p>
<p>The buffer gets written to the sector specified by the global field fCurrentSector. Additionally, there will be written a NOFS_TERMINAL into the respective next sector (i.e. fCurrentSector + 1). This ensures that the scanning algorithm during initialization won't fail to find a terminal symbol. </p>

</div>
</div>
<a class="anchor" id="a050245f618719c9f18f003792d835ed7"></a><!-- doxytag: member="nofs.h::nofs_init" ref="a050245f618719c9f18f003792d835ed7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="nofs_8h.html#a050245f618719c9f18f003792d835ed7">nofs_init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the NoFS. Locks the processor in case of error. </p>

</div>
</div>
<a class="anchor" id="a2ccac30932e224986477db6ae166b688"></a><!-- doxytag: member="nofs.h::nofs_writeString" ref="a2ccac30932e224986477db6ae166b688" args="(char *pString)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="nofs_8h.html#a2ccac30932e224986477db6ae166b688">nofs_writeString</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pString</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Appends a character string to the present data. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pString</td><td>A null-terminated character string which should be written </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="nofs_8h.html">nofs.h</a>      </li>

    <li class="footer">Generated on Sun Apr 8 2012 14:53:03 for gLogger Mini by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
